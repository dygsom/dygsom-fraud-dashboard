# üìã Plan de Despliegue Azure - DYGSOM Fraud Dashboard

## üéØ **Objetivo**
Desplegar el dashboard de detecci√≥n de fraude DYGSOM en Azure usando Azure Developer CLI (AZD) con arquitectura optimizada para MVP y costos controlados.

## üìä **Informaci√≥n del Proyecto**

### **DYGSOM Fraud Dashboard**
- **Stack Tecnol√≥gico**: Next.js 14.2.0 + TypeScript + TailwindCSS
- **Tipo de Aplicaci√≥n**: Dashboard web de fraud detection con branding DYGSOM
- **Containerizaci√≥n**: Listo para despliegue con Dockerfile existente
- **Dependencias**: Backend API externo, Application Insights para monitoreo
- **Recomendaci√≥n de Hosting**: Azure App Service para hosting web escalable y costo-eficiente

### **Caracter√≠sticas del Proyecto**
- ‚úÖ Aplicaci√≥n Next.js completa con SSR
- ‚úÖ Autenticaci√≥n JWT implementada
- ‚úÖ Dashboard analytics con gr√°ficos
- ‚úÖ Sistema de gesti√≥n de API keys
- ‚úÖ Branding DYGSOM completo
- ‚úÖ Dockerfile optimizado para producci√≥n
- ‚úÖ Variables de entorno configuradas

## üèóÔ∏è **Arquitectura de Recursos Azure**

> **Instala la extensi√≥n de Mermaid en tu IDE para visualizar la arquitectura.**

```mermaid
graph TB
    subgraph "Usuarios"
        U[üë• Admins DYGSOM]
    end
    
    subgraph "CDN & Security"
        FD[üåê Azure Front Door<br/>CDN + WAF Protection]
    end
    
    subgraph "Compute"
        AS[üñ•Ô∏è App Service<br/>Next.js Dashboard<br/>B1 Standard]
    end
    
    subgraph "External APIs"
        API[üîß Backend Fraud API<br/>External Service]
    end
    
    subgraph "Monitoring"
        AI[üìä Application Insights<br/>Telemetry & Logs]
        LA[üìã Log Analytics<br/>Centralized Logging]
    end
    
    subgraph "Security"
        KV[üîê Key Vault<br/>Secrets Management]
    end
    
    U --> FD
    FD --> AS
    AS --> API
    AS --> AI
    AS --> KV
    AI --> LA
    
    classDef compute fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef external fill:#fff3e0,stroke:#ef6c00,stroke-width:2px
    classDef monitoring fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef security fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    
    class AS compute
    class API external
    class AI,LA monitoring
    class KV security
```

### **Flujo de Datos**
- El Azure Front Door act√∫a como CDN y WAF para el App Service
- El App Service obtiene su contenido del c√≥digo deployado desde GitHub
- El App Service hace llamadas HTTPS al backend fraud detection API externo
- Application Insights captura telemetr√≠a y m√©tricas de la aplicaci√≥n

## üöÄ **Recursos Azure Recomendados**

### **Servicio Principal de Aplicaci√≥n**

**Aplicaci√≥n: dygsom-fraud-dashboard**
- **Servicio de Hosting**: Azure App Service (Web App)
- **SKU Recomendado**: B1 Standard (1 Core, 1.75GB RAM, 10GB Storage)
  - **Performance**: Ideal para MVP con 100+ usuarios concurrentes
  - **Costo**: ~$13-15 USD/mes
  - **Auto-escalado**: Disponible para crecimiento futuro
  
- **Configuraci√≥n**:
  - **Lenguaje**: Node.js 18 LTS
  - **Puerto**: 3001
  - **Variables de Entorno**:
    - `NEXT_PUBLIC_APP_NAME=DYGSOM Fraud Dashboard`
    - `NEXT_PUBLIC_API_BASE_URL={Backend API URL}`
    - `NEXT_PUBLIC_ENVIRONMENT=production`
    - `APPLICATIONINSIGHTS_CONNECTION_STRING={AI Connection String}`
    - `NEXT_PUBLIC_LOG_LEVEL=error`
    - Y 10+ variables adicionales seg√∫n .env.example

### **Recursos de Dependencias**

**1. Application Insights**
- **SKU**: Est√°ndar (Pay-as-you-go)
- **Tipo de Servicio**: Azure Application Insights
- **Tipo de Conexi√≥n**: Connection String
- **Costo Estimado**: ~$2-5 USD/mes para MVP
- **Variables de Entorno**: 
  - `APPLICATIONINSIGHTS_CONNECTION_STRING`

**2. Azure Front Door**
- **SKU**: Est√°ndar
- **Caracter√≠sticas**: CDN + WAF b√°sico
- **Costo Estimado**: ~$20-30 USD/mes
- **Beneficios**: Protecci√≥n DDoS, cach√© global, SSL autom√°tico

**3. Azure Key Vault**
- **SKU**: Est√°ndar
- **Prop√≥sito**: Almacenar secretos de API y connection strings
- **Costo Estimado**: ~$3-5 USD/mes
- **Variables gestionadas**: API keys, tokens, connection strings

### **Servicios de Soporte Recomendados**

**Monitoreo y Logging**
- **Application Insights**: Telemetr√≠a de aplicaci√≥n
- **Log Analytics Workspace**: Logs centralizados de todos los servicios
- **Azure Monitor**: Alertas y dashboards

**Configuraciones de Seguridad Recomendadas**
- **Managed Identity**: Para acceso seguro a Key Vault
- **HTTPS Only**: Forzar conexiones seguras
- **API Management**: Para rate limiting del frontend (opcional)
- **Azure AD Integration**: Para autenticaci√≥n empresarial (futuro)

## üí∞ **Estimaci√≥n de Costos Mensual (MVP)**

### **Costos Core (M√≠nimos)**
| Servicio | SKU | Costo Mensual (USD) |
|----------|-----|-------------------|
| App Service | B1 Standard | $13-15 |
| Application Insights | Pay-as-go | $2-5 |
| Key Vault | Standard | $3-5 |
| **TOTAL BASE** | | **$18-25** |

### **Costos con Optimizaciones (Recomendado)**
| Servicio | SKU | Costo Mensual (USD) |
|----------|-----|-------------------|
| App Service | B1 Standard | $13-15 |
| Front Door | Standard | $20-30 |
| Application Insights | Pay-as-go | $2-5 |
| Key Vault | Standard | $3-5 |
| **TOTAL OPTIMIZADO** | | **$38-55** |

### **‚ö†Ô∏è Consideraciones de Costos MVP**

**Configuraci√≥n M√≠nima (Desarrollo/Testing)**
- **Solo App Service B1**: $13-15/mes
- **Application Insights basic**: $2-5/mes
- **Total**: **$15-20/mes**

**Configuraci√≥n Producci√≥n (Recomendada)**
- **Con Front Door y seguridad**: $38-55/mes
- **Escalabilidad autom√°tica incluida**
- **Monitoreo profesional completo**

## üìù **Pasos de Ejecuci√≥n**

> **Los siguientes pasos deben ejecutarse por Copilot; pide a Copilot que actualice o ejecute este plan.**

### **1. Provisionar Infraestructura Azure y Desplegar Aplicaci√≥n**

1. **Obtener reglas IaC**: Usar herramienta `iac-rules-get` para Azure App Service
2. **Generar archivos Bicep**: Crear infraestructura basada en el plan de recursos
3. **Pre-validaci√≥n**: Usar `get_errors` para verificar sintaxis de Bicep
4. **Ejecutar AZD**: Comando `azd up` para provisionar recursos
5. **Verificar despliegue**: Confirmar que todos los recursos est√°n creados
6. **Verificar logs**: Usar `azd-app-log-get` para asegurar servicios funcionando

### **2. Configuraci√≥n Post-Despliegue**

1. **Configurar variables de entorno** en App Service
2. **Configurar Application Insights** connection string
3. **Configurar Custom Domain** (opcional)
4. **Configurar SSL Certificate** autom√°tico
5. **Configurar alertas** b√°sicas en Azure Monitor

### **3. Validaci√≥n y Testing**

1. **Smoke test**: Verificar que la aplicaci√≥n carga correctamente
2. **API connectivity**: Verificar conexi√≥n con backend fraud API
3. **Authentication flow**: Probar login y dashboard access
4. **Performance test**: Verificar tiempos de respuesta b√°sicos

### **4. Documentaci√≥n Final**

1. **Generar resumen** de despliegue en `.azure/summary.copilotmd`
2. **Documentar URLs** de producci√≥n y staging
3. **Documentar proceso** de CI/CD para futuros deployments
4. **Crear runbook** para troubleshooting com√∫n

---

## ‚úÖ **Entregables Esperados**

1. **Dashboard funcionando** en URL de producci√≥n
2. **Monitoreo activo** con Application Insights
3. **Logs centralizados** en Log Analytics
4. **Documentaci√≥n completa** de la arquitectura deployada
5. **Runbook de mantenimiento** para el equipo

**Estado**: ‚úÖ **Listo para ejecutar con `azd up`**